<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.28
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-RedAmber">RedAmber</h1>

<p><a href="https://badge.fury.io/rb/red_amber"><img src="https://badge.fury.io/rb/red_amber.svg"></a> <a href="https://github.com/heronshoes/red_amber/actions/workflows/ci.yml"><img src="https://github.com/heronshoes/red_amber/actions/workflows/ci.yml/badge.svg"></a> <a href="https://github.com/heronshoes/red_amber/discussions"><img src="https://img.shields.io/github/discussions/heronshoes/red_amber"></a></p>

<p>A simple dataframe library for Ruby.</p>
<ul><li>
<p>Powered by <a href="https://github.com/apache/arrow/tree/master/ruby/red-arrow">Red Arrow</a> <a href="https://gitter.im/red-data-tools/en"><img src="https://badges.gitter.im/red-data-tools/en.svg"></a></p>
</li><li>
<p>Inspired by the dataframe library <a href="https://github.com/ankane/rover">Rover-df</a></p>
</li></ul>

<p><img src="doc/image/screenshot.png"></p>

<h2 id="label-Requirements">Requirements</h2>

<p>Supported Ruby version is &gt;= 2.7.</p>

<p>Since v0.2.0, this library uses pattern matching which is an experimental feature in 2.7 . It is usable but a warning message will be shown in 2.7 . I recommend Ruby 3 for performance.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Libraries required
</span><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red-arrow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 10.0.0</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># Requires Apache Arrow (see installation below)
</span>
<span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red-parquet</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 10.0.0</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># Optional, if you use IO from/to parquet
</span><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rover-df</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 0.3.0</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># Optional, if you use IO from/to Rover::DataFrame
</span></code></pre>

<h2 id="label-Installation">Installation</h2>

<p>Install requirements before you install Red Amber.</p>
<ul><li>
<p>Apache Arrow (~&gt; 10.0.0)</p>
</li><li>
<p>Apache Arrow GLib (~&gt; 10.0.0)</p>
</li><li>
<p>Apache Parquet GLib (~&gt; 10.0.0) # If you use IO from/to parquet</p>
</li></ul>

<p>See <a href="https://arrow.apache.org/install/">Apache Arrow install document</a>.</p>
<ul><li>
<p>Minimum installation example for the latest Ubuntu:</p>

<pre class="code ruby"><code class="ruby">sudo apt update
sudo apt install -y -V ca-certificates lsb-release wget
wget https://apache.jfrog.io/artifactory/arrow/$(lsb_release --id --short | tr &#39;A-Z&#39; &#39;a-z&#39;)/apache-arrow-apt-source-latest-$(lsb_release --codename --short).deb
sudo apt install -y -V ./apache-arrow-apt-source-latest-$(lsb_release --codename --short).deb
sudo apt update
sudo apt install -y -V libarrow-dev
sudo apt install -y -V libarrow-glib-dev
</code></pre>
</li><li>
<p>On macOS, you can install Apache Arrow C++ library using Homebrew:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_brew'>brew</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_apache'>apache</span><span class='op'>-</span><span class='id identifier rubyid_arrow'>arrow</span>
</code></pre>

<p>and GLib (c) package with:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_brew'>brew</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_apache'>apache</span><span class='op'>-</span><span class='id identifier rubyid_arrow'>arrow</span><span class='op'>-</span><span class='id identifier rubyid_glib'>glib</span>
</code></pre>
</li></ul>

<p>If you prepared Apache Arrow, add these lines to your Gemfile:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red-arrow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 10.0.0</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red_amber</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red-parquet</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 10.0.0</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># Optional, if you use IO from/to parquet
</span><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rover-df</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>~&gt; 0.3.0</span><span class='tstring_end'>&#39;</span></span>  <span class='comment'># Optional, if you use IO from/to Rover::DataFrame
</span><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red-datasets-arrow</span><span class='tstring_end'>&#39;</span></span>       <span class='comment'># Optional, recommended if you use Red Datasets
</span><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red-arrow-numo-narray</span><span class='tstring_end'>&#39;</span></span>    <span class='comment'># Optional, recommended if you use inputs from Numo::NArray
</span></code></pre>

<p>And then execute <code>bundle install</code> or install it yourself as <code>gem install red_amber</code>.</p>

<h2 id="label-Docker+image+and+Jupyter+Notebook">Docker image and Jupyter Notebook</h2>

<p><a href="https://github.com/RubyData/docker-stacks">RubyData Docker Stacks</a> is available as a ready-to-run Docker image containing Jupyter and useful data tools as well as RedAmber (Thanks to @mrkn).</p>

<p>Also you can try the contents of this README interactively by <a href="https://mybinder.org/v2/gh/heronshoes/docker-stacks/RedAmber-binder?filepath=red-amber.ipynb">Binder</a>. <a href="https://mybinder.org/v2/gh/heronshoes/docker-stacks/RedAmber-binder?filepath=red-amber.ipynb"><img src="https://mybinder.org/badge_logo.svg"></a></p>

<h2 id="label-Data+frame+in+RedAmber">Data frame in <code>RedAmber</code></h2>

<p>Class <code>RedAmber::DataFrame</code> represents a set of data in 2D-shape. The entity is a Red Arrow’s Table object.</p>

<p><img src="doc/image/dataframe_model.png"></p>

<p>Let’s load the library and try some examples.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>red_amber</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># require &#39;red-amber&#39; is also OK.
</span><span class='id identifier rubyid_include'>include</span> <span class='const'>RedAmber</span>
</code></pre>

<h3 id="label-Example-3A+diamonds+dataset">Example: diamonds dataset</h3>

<pre class="code ruby"><code class="ruby">require &#39;datasets-arrow&#39; # to load sample data

dataset = Datasets::Diamonds.new
diamonds = DataFrame.new(dataset) # from v0.2.2, should be `dataset.to_arrow` if older.

# =&gt;
#&lt;RedAmber::DataFrame : 53940 x 10 Vectors, 0x000000000000f668&gt;
         carat cut       color    clarity     depth    table    price        x ...        z
      &lt;double&gt; &lt;string&gt;  &lt;string&gt; &lt;string&gt; &lt;double&gt; &lt;double&gt; &lt;uint16&gt; &lt;double&gt; ... &lt;double&gt;
    0     0.23 Ideal     E        SI2          61.5     55.0      326     3.95 ...     2.43
    1     0.21 Premium   E        SI1          59.8     61.0      326     3.89 ...     2.31
    2     0.23 Good      E        VS1          56.9     65.0      327     4.05 ...     2.31
    3     0.29 Premium   I        VS2          62.4     58.0      334      4.2 ...     2.63
    4     0.31 Good      J        SI2          63.3     58.0      335     4.34 ...     2.75
    :        : :         :        :               :        :        :        : ...        :
53937      0.7 Very Good D        SI1          62.8     60.0     2757     5.66 ...     3.56
53938     0.86 Premium   H        SI2          61.0     58.0     2757     6.15 ...     3.74
53939     0.75 Ideal     D        SI2          62.2     55.0     2757     5.83 ...     3.64
</code></pre>

<p>For example, we can compute mean prices per cut for the data larger than 1 carat.</p>

<pre class="code ruby"><code class="ruby">df = diamonds
  .slice { carat &gt; 1 }
  .group(:cut)
  .mean(:price) # `pick` prior to `group` is not required if `:price` is specified here.
  .sort(&#39;-mean(price)&#39;)

# =&gt;
#&lt;RedAmber::DataFrame : 5 x 2 Vectors, 0x000000000000f67c&gt;
  cut       mean(price)
  &lt;string&gt;     &lt;double&gt;
0 Ideal         8674.23
1 Premium       8487.25
2 Very Good     8340.55
3 Good           7753.6
4 Fair          7177.86
</code></pre>

<p>Arrow data is immutable, so these methods always return new objects. Next example will rename a column and create a new column by simple calcuration.</p>

<pre class="code ruby"><code class="ruby">usdjpy = 110.0 # when the yen was stronger

df.rename(&#39;mean(price)&#39;: :mean_price_USD)
  .assign(:mean_price_JPY) { mean_price_USD * usdjpy }

# =&gt;
#&lt;RedAmber::DataFrame : 5 x 3 Vectors, 0x000000000000f71c&gt;
  cut       mean_price_USD mean_price_JPY
  &lt;string&gt;        &lt;double&gt;       &lt;double&gt;
0 Ideal            8674.23      954164.93
1 Premium          8487.25      933597.34
2 Very Good        8340.55      917460.37
3 Good              7753.6      852896.11
4 Fair             7177.86      789564.12
</code></pre>

<h3 id="label-Example-3A+starwars+dataset">Example: starwars dataset</h3>

<p>Next example is <code>starwars</code> dataset reading from the downloaded CSV file. Followed by minimum data cleansing.</p>

<pre class="code ruby"><code class="ruby">uri = URI(&#39;https://vincentarelbundock.github.io/Rdatasets/csv/dplyr/starwars.csv&#39;)

starwars = DataFrame.load(uri)

starwars
  .drop(0) # delete unnecessary index column
  .remove { species == &quot;NA&quot; } # delete unnecessary rows
  .group(:species) { [count(:species), mean(:height, :mass)] }
  .slice { count &gt; 1 }

# =&gt;
#&lt;RedAmber::DataFrame : 8 x 4 Vectors, 0x000000000000f848&gt;
  species    count mean(height) mean(mass)
  &lt;string&gt; &lt;int64&gt;     &lt;double&gt;   &lt;double&gt;
0 Human         35       176.65      82.78
1 Droid          6        131.2      69.75
2 Wookiee        2        231.0      124.0
3 Gungan         3       208.67       74.0
4 Zabrak         2        173.0       80.0
5 Twi&#39;lek        2        179.0       55.0
6 Mirialan       2        168.0       53.1
7 Kaminoan       2        221.0       88.0
</code></pre>

<p>See <a href="doc/DataFrame_md.html">DataFrame.md</a> for other examples and details.</p>

<h3 id="label-Vector+for+1D+data+object+in+column"><code>Vector</code> for 1D data object in column</h3>

<p>Class <code>RedAmber::Vector</code> represents a series of data in the DataFrame.</p>

<p>See <a href="doc/Vector_md.html">Vector.md</a> for details.</p>

<h2 id="label-Jupyter+notebook">Jupyter notebook</h2>

<p><a href="https://github.com/heronshoes/docker-stacks/blob/RedAmber-binder/binder/examples_of_red_amber.ipynb">83 Examples of Red Amber</a> (<a href="https://raw.githubusercontent.com/heronshoes/docker-stacks/RedAmber-binder/binder/examples_of_red_amber.ipynb">raw file</a>) shows more examples in jupyter notebook.</p>

<p>You can try this notebook on <a href="https://mybinder.org/v2/gh/heronshoes/docker-stacks/RedAmber-binder?filepath=examples_of_red_amber.ipynb">Binder</a>. <a href="https://mybinder.org/v2/gh/heronshoes/docker-stacks/RedAmber-binder?filepath=examples_of_red_amber.ipynb"><img src="https://mybinder.org/badge_logo.svg"></a></p>

<h2 id="label-Development">Development</h2>

<pre class="code ruby"><code class="ruby">git clone https://github.com/heronshoes/red_amber.git
cd red_amber
bundle install
bundle exec rake test
</code></pre>

<h2 id="label-Community">Community</h2>

<p>I will appreciate if you could help to improve this project. Here are a few ways you can help:</p>
<ul><li>
<p>Let’s talk in the <a href="https://github.com/heronshoes/red_amber/discussions">discussions</a>. <a href="https://github.com/heronshoes/red_amber/discussions"><img src="https://img.shields.io/github/discussions/heronshoes/red_amber"></a></p>
</li><li>
<p>Browse Q and A, how to use, tips, etc.</p>
</li><li>
<p>Ask questions you’re wondering about.</p>
</li><li>
<p>Share ideas. The idea may be promoted to issues or pull requests.</p>
</li><li>
<p><a href="https://github.com/heronshoes/red_amber/issues">Report bugs or suggest new features</a></p>
</li><li>
<p>Fix bugs and <a href="https://github.com/heronshoes/red_amber/pulls">submit pull requests</a></p>
</li><li>
<p>Write, clarify, or fix documentation</p>
</li></ul>

<h2 id="label-License">License</h2>

<p>The gem is available as open source under the terms of the <a href="https://opensource.org/licenses/MIT">MIT License</a>.</p>
</div></div>

      <div id="footer">
  Generated on Tue Dec 13 10:13:44 2022 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.28 (ruby-3.1.3).
</div>

    </div>
  </body>
</html>